{
  "geometries": {
    "epa_aqs_sites": {
      "foreign_key": {
        "columns": [{
            "name": "State Code",
            "width": 2
          },
          {
            "name": "County Code",
            "width": 3
          },
          {
            "name": "Site Num",
            "width": 4
          }
        ],
        "separator": "-"
      },
      "meta": {
        "table_name": "geom_epa_aqs_sites",
        "schema": "public",
        "data_type_name": "POINT",
        "data_type_id": "0",
        "geom_type_concept_id": "0",
        "geom_type_source_value": "EPA AQS Site. Identified AS (State FIPS - County FIPS - EPA Site Number) SS-CCC-NNNN",
        "data_source_id": "0",
        "espg_local": "0",
        "table_desc": "Sourced from pre-calculated csv (zip) file of EPA AQS sites available from "
      }
    },
    "tiger_counties_FIPS": {
      "foreign_key": {
        "columns": [{
            "name": "State Code",
            "width": 2
          },
          {
            "name": "County Code",
            "width": 3
          }
        ],
        "separator": ""
      },
      "meta": {
        "table_name": "geom_tiger_counties",
        "schema": "public",
        "data_type_name": "POLYGON",
        "data_type_id": "2",
        "geom_type_concept_id": "0",
        "geom_type_source_value": "US County. Identified AS (State FIPS - County FIPS) SSCCC",
        "data_source_id": "0",
        "espg_local": "0",
        "table_desc": "Sourced from Census Geography Division available from "
      }
    },
    "tiger_counties_names": {
      "foreign_key": {
        "_comment": "these tables do not use FIPS!!",
        "columns": [{
            "name": "State",
            "width": -1
          },
          {
            "name": "County",
            "width": -1
          }
        ],
        "separator": ""
      },
      "meta": {
        "table_name": "geom_tiger_counties",
        "schema": "public",
        "data_type_name": "POLYGON",
        "data_type_id": "2",
        "geom_type_concept_id": "0",
        "geom_type_source_value": "US County. Identified AS SQL AND on state name and county name",
        "data_source_id": "0",
        "espg_local": "0",
        "table_desc": "Sourced from Census Geography Division available from "
      }
    },
    "tiger_CBSAs": {
      "geom_layer": "tiger_cbsa",
      "foreign_key": {
        "columns": [{
          "name": "CBSA Code",
          "width": 5
        }],
        "separator": ""
      },
      "meta": {
        "table_name": "geom_tiger_cbsa",
        "schema": "public",
        "data_type_name": "POLYGON",
        "data_type_id": "2",
        "geom_type_concept_id": "0",
        "geom_type_source_value": "US Census Bureau Statistical Area. Identified AS (State FIPS - County FIPS) SSCCC",
        "data_source_id": "0",
        "espg_local": "0",
        "table_desc": "Sourced from Census Geography Division available from "
      }
    }
  },
  "attributes": {
    "annual_conc": [
      {
        "column": "Arithmetic Mean",
        "destination": "value_as_number"
      },
      {
        "column": "Units of Measure",
        "destination": "unit_source_value"
      },
      {
        "_comment": "is this correct? Then look up in table of EPA codes and names?",
        "column": "Parameter Name",
        "destination": "attr_source_value"
      },
      {
        "column": "Parameter Code",
        "destination": "attr_source_concept_id"
      },
      {
        "column": "Year",
        "destination": "attr_start_date",
        "_comment": "start date as Jan 01 of year"
      },
      {
        "column": "Year",
        "destination": "attr_end_date",
        "_comment": "end date as Dec 31 of year"
      }
    ],
    "annual_aqi": [
      {
        "column": ["Days with AQI", "Good Days", "Moderate Days", "Unhealthy for Sensitive Groups Days", "Unhealthy Days", "Very Unhealthy Days", "Hazardous Days", "Max AQI", "90th Percentile AQI", "Median AQI", "Days CO", "Days NO2", "Days Ozone", " Days SO2", "Days PM2.5", "Days PM10"],
        "destination": "value_as_number"
      },
      {
        "value": ["Days", "Days", "Days", "Days", "Days", "Days", "Days", "AQI", "AQI", "AQI", "Days", "Days", "Days", " Days", "Days", "Days"],
        "destination": "unit_source_value"
      },
      {
        "value": ["Days with AQI", "Good Days", "Moderate Days", "Unhealthy for Sensitive Groups Days", "Unhealthy Days", "Very Unhealthy Days", "Hazardous Days", "Max AQI", "90th Percentile AQI", "Median AQI", "Days CO", "Days NO2", "Days Ozone", " Days SO2", "Days PM2.5", "Days PM10"],
        "destination": "attr_source_value"
      },
      {
        "column": "Year",
        "destination": "attr_start_date"
      },
      {
        "column": "Year",
        "destination": "attr_end_date"
      }
    ],
    "daily_parameters": [
      {
        "column": "Arithmetic Mean",
        "destination": "value_as_number"
      },
      {
        "column": "Units of Measure",
        "destination": "unit_source_value"
      },
      {
        "column": "Parameter Code",
        "destination": "attr_source_concept_id"
      },
      {
        "column": "Parameter Name",
        "destination": "attr_source_value"
      },
      {
        "column": "Date Local",
        "destination": "attr_start_date"
      },
      {
        "column": "Date Local",
        "destination": "attr_end_date"
      }
    ],
    "daily_aqi": [
      {
        "column": "AQI",
        "destination": "value_as_number"
      },
      {
        "value": "AQI",
        "destination": "unit_source_value"
      },
      {
        "value": "AQI",
        "destination": "attr_source_value"
      },
      {
        "column": "Date",
        "destination": "attr_start_date"
      },
      {
        "column": "Date",
        "destination": "attr_end_date"
      }
    ]
  },
  "meta": [
    {
      "temporal_span": "annual",
      "datasets": [
        {
          "measures": [
            {
              "name": "conc",
              "description": "concentrations"
            }
          ],
          "geometries": [
            {
              "name": "monitor",
              "description": "specific monitor at a site",
              "geometry": "epa_aqs_sites",
              "year": {
                "_comment": "iterate over or select subset of years and param_codes",
                "year": "years",
                "param_codes": "param_codes",
                "attributes": "annual_conc",
                "inclusion_criteria": {
                  "column": "Observation Percent",
                  "operator": "gt",
                  "value": "50"
                }
              }
            }
          ]
        },
        {
          "measures": [
            {
              "name": "aqi",
              "description": "air quality index"
            }
          ],
          "geometries": [{
              "name": "cbsa",
              "description": "core based statistical area",
              "geometry": "tiger_CBSAs",
              "year": {
                "_comment": "iterate over or select subset of years and aggregate variables",
                "year": "years",
                "aggregate_variables": "aggregate_variables",
                "attributes": "annual_aqi"
              }
            },
            {
              "name": "county",
              "description": "US counties",
              "joins_with": "tiger_counties_names",
              "year": {
                "_comment": "iterate over or select subset of years and param_codes",
                "year": "years",
                "aggregate_variables": "aggregate_variables",
                "attributes": "annual_aqi"
              }
            }
          ]
        }
      ]
    },
    {
      "temporal_span": "daily",
      "datasets": [
        {
          "measures": [
            {
              "name": "44201",
              "description": "Ozone"
            },
            {
              "name": "42401",
              "description": "SO2"
            },
            {
              "name": "42101",
              "description": "CO"
            },
            {
              "name": "42602",
              "description": "NO2"
            },
            {
              "name": "88101",
              "description": "PM2.5 FRM/FEM Mass"
            },
            {
              "name": "88502",
              "description": "PM2.5 non FRM/FEM"
            },
            {
              "name": "81102",
              "description": "PM10 Mass"
            },
            {
              "name": "SPEC",
              "description": "PM2.5 Speciation"
            },
            {
              "name": "PM10SPEC",
              "description": "PM10 Speciation"
            },
            {
              "name": "WIND",
              "description": "Winds (Resultant)"
            },
            {
              "name": "TEMP",
              "description": "Temperature (62101)"
            },
            {
              "name": "PRESS",
              "description": "Barometric Pressure (64101)"
            },
            {
              "name": "RH_DP",
              "description": "RH and Dewpoint"
            },
            {
              "name": "HAPS",
              "description": "Haps"
            },
            {
              "name": "VOCS",
              "description": "VOCs"
            },
            {
              "name": "NONOxNOy",
              "description": "NONOxNOy"
            },
            {
              "name": "LEAD",
              "description": "Lead"
            }
          ],
          "geometries": [
            {
              "name": "",
              "description": "specific monitor at a site",
              "joins_with": "epa_aqs_sites",
              "year": {
                "_comment": "iterate over or select subset of years",
                "year": "years",
                "attributes": "daily_parameters",
                "inclusion_criteria": {
                  "column": "Observation Percent",
                  "operator": "gt",
                  "value": "50"
                }
              }
            }
          ]
        },
        {
          "measures": [
            {
              "name": "aqi",
              "description": "air quality index"
            }
          ],
          "geometries": [{
              "name": "cbsa",
              "description": "core based statistical area",
              "geometry": "tiger_CBSAs",
              "year": {
                "_comment": "iterate over or select subset of years and aggregate variables",
                "year": "years",
                "aggregate_variables": "aggregate_variables",
                "attributes": "daily_aqi"
              }
            },
            {
              "name": "counties",
              "description": "US counties",
              "joins_with": "tiger_counties_FIPS",
              "year": {
                "_comment": "iterate over or select subset of years and param_codes",
                "year": "years",
                "aggregate_variables": "aggregate_variables",
                "attributes": "daily_aqi"
              }
            }
          ]
        }
      ]
    }
  ]
}
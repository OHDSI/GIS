<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title> Gaia Design Principles</title>

<script src="site_libs/header-attrs-2.30/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-6.5.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet" />
<link rel='shortcut icon' type='image/x-icon' href='favicon.ico' />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"><div><img src="ohdsi16x16.png"></img> OHDSI GIS </div></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="get-started.html">
    <span class="fa fa-play"></span>
     
    Get Started
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-earth"></span>
     
    Gaia
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="gaia-intro.html">Overview</a>
    </li>
    <li>
      <a href="gaia-principles.html">Design</a>
    </li>
    <li>
      <a href="schema-extensions.html">Schema Extensions</a>
    </li>
    <li>
      <a href="use-cases.html">Use Cases</a>
    </li>
    <li>
      <a href="analysis.html">Analysis</a>
    </li>
    <li>
      <a href="gaiaDb.html">gaiaDb</a>
    </li>
    <li>
      <a href="gaiaCore.html">gaiaCore</a>
    </li>
    <li>
      <a href="gaiaCatalog.html">gaiaCatalog</a>
    </li>
    <li>
      <a href="gaiaDocker.html">gaiaDocker</a>
    </li>
  </ul>
</li>
<li>
  <a href="vocabulary.html">
    <span class="fa fa-book"></span>
     
    Vocabulary
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-code"></span>
     
    Developer
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="developer.html">Overview</a>
    </li>
    <li>
      <a href="developer-packages.html">Package Status</a>
    </li>
    <li>
      <a href="developer-contributing.html">Contributing</a>
    </li>
    <li>
      <a href="developer-architecture.html">Architecture</a>
    </li>
    <li>
      <a href="developer-deployment.html">Deployment</a>
    </li>
  </ul>
</li>
<li>
  <a href="project-management.html">
    <span class="fa fa-tasks"></span>
     
    Project Management
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/OHDSI/GIS">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore"><img src="ohdsi40x40.png"></img> Gaia
Design Principles</h1>

</div>


<p><br></p>
<div id="design-rationale" class="section level1">
<h1><strong>Design Rationale</strong></h1>
<p><br></p>
<div id="use-case-requirements" class="section level2">
<h2>Use Case Requirements</h2>
<p>The Gaia toolchain was designed to meet specific research
requirements for integrating geospatial data with patient health
data:</p>
<p><strong>Research Goals</strong>: - Link patient locations to
environmental and social exposures over time - Harmonize disparate
geospatial datasets from multiple sources - Calculate spatiotemporal
exposure metrics while preserving patient privacy - Enable reproducible,
federated network studies - Support diverse spatial data types
(polygons, points, rasters)</p>
<p><strong>Technical Requirements</strong>: - Standardized
representation for heterogeneous geospatial data - Automated retrieval
and ingestion of external datasets - Efficient storage and query
performance for large spatial datasets - Extensible architecture
supporting community growth - Integration with OMOP CDM and HADES
analytics tools</p>
<p><br></p>
</div>
<div id="core-design-goals" class="section level2">
<h2>Core Design Goals</h2>
<p>The foundational goals driving Gaia’s architecture:</p>
<div id="extensibility" class="section level3">
<h3><strong>Extensibility</strong></h3>
<ul>
<li><strong>Common data model</strong> enables stable tooling
development</li>
<li><strong>Collaborative growth</strong> through shared metadata
repository</li>
<li><strong>Ontology integration</strong> via OMOP vocabulary
standards</li>
<li><strong>Language-agnostic access</strong> through RESTful API and
database connections</li>
</ul>
</div>
<div id="automation" class="section level3">
<h3><strong>Automation</strong></h3>
<ul>
<li><strong>Data retrieval</strong> from external sources via functional
metadata</li>
<li><strong>Standardization</strong> through transformation recipes</li>
<li><strong>Ingestion</strong> into harmonized schema</li>
<li><strong>Deployment</strong> via containerized stack
(gaiaDocker)</li>
</ul>
</div>
<div id="efficiency" class="section level3">
<h3><strong>Efficiency</strong></h3>
<ul>
<li><strong>Storage design</strong> using Entity-Attribute-Value
structure</li>
<li><strong>Spatial indexing</strong> for query performance</li>
<li><strong>Centralized metadata</strong> reduces duplication of ETL
effort</li>
<li><strong>Modular architecture</strong> allows independent component
development</li>
</ul>
<p><br></p>
<hr />
</div>
</div>
</div>
<div id="architecture-strategy" class="section level1">
<h1><strong>Architecture Strategy</strong></h1>
<p><br></p>
<div id="design-approach" class="section level2">
<h2>Design Approach</h2>
<table>
<colgroup>
<col width="52%" />
<col width="47%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Challenge</th>
<th align="left">Approach</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Enable extensible tooling</td>
<td align="left">Implement common data model for place-related data</td>
</tr>
<tr class="even">
<td align="left">Universal representation for any geospatial data</td>
<td align="left">Represent data as geometries and attributes (of
geometries)</td>
</tr>
<tr class="odd">
<td align="left">Efficiency with large standardized datasets</td>
<td align="left">Split each data source into own pair of geometry and
attribute tables</td>
</tr>
<tr class="even">
<td align="left">Static functionality for any new data</td>
<td align="left">Indexing structures and parameterization treat
disparate tables as functionally combined</td>
</tr>
<tr class="odd">
<td align="left">Maintain source provenance and versioning</td>
<td align="left">Data source and variable metadata with unique
identifiers referenced throughout schema</td>
</tr>
<tr class="even">
<td align="left">Automate retrieval, ingestion, standardization</td>
<td align="left">“Functional metadata” at data source and variable
level, executed via gaiaDb SQL functions</td>
</tr>
<tr class="odd">
<td align="left">Enable collaborative metadata growth</td>
<td align="left">Host metadata centrally (gaiaCatalog), not actual data
sources</td>
</tr>
</tbody>
</table>
<p><br></p>
</div>
<div id="data-pipeline" class="section level2">
<h2>Data Pipeline</h2>
<p>Gaia processes geospatial data through a standardized pipeline:</p>
<pre><code>External Data Sources
    ↓
gaiaCatalog (Metadata Repository)
    ↓ [Functional metadata specifications]
gaiaDb ETL Functions (SQL/PostGIS)
    ↓ [Automated retrieval &amp; transformation]
Harmonized Backbone Schema
    ↓ [GEOM_* and ATTR_* tables]
gaiaCore Access Layer
    ↓ [API or database connections]
Client Applications (R, Python, etc.)</code></pre>
<p><strong>Pipeline stages</strong>:</p>
<ol style="list-style-type: decimal">
<li><strong>Discovery</strong>: gaiaCatalog contains metadata for
external datasets</li>
<li><strong>Retrieval</strong>: gaiaDb functions fetch data from source
URLs</li>
<li><strong>Transform</strong>: Transformation recipes (geom_spec,
attr_spec) standardize data</li>
<li><strong>Load</strong>: Data inserted into GEOM_* and ATTR_*
tables</li>
<li><strong>Index</strong>: GEOM_INDEX and ATTR_INDEX populated for
parameterized querying</li>
<li><strong>Access</strong>: gaiaCore provides multi-language access to
harmonized data</li>
</ol>
<p><br></p>
<p><img src="images/pipeline_flow.png" /></p>
<p><em>Gaia data flow from external sources through catalog metadata to
harmonized storage and client access</em></p>
<p><br></p>
<hr />
</div>
</div>
<div id="backbone-schema" class="section level1">
<h1><strong>Backbone Schema</strong></h1>
<p><br></p>
<div id="schema-overview" class="section level2">
<h2>Schema Overview</h2>
<p>The gaiaDb backbone schema consists of three distinct portions:</p>
<p><br></p>
<div id="metadata-tables" class="section level3">
<h3><strong>1. Metadata Tables</strong></h3>
<p><strong>DATA_SOURCE</strong> and <strong>VARIABLE_SOURCE</strong>
contain both descriptive and functional metadata:</p>
<ul>
<li><strong>DATA_SOURCE</strong>: Catalogs external web-hosted datasets
<ul>
<li>One row per unique data source</li>
<li>Contains geom_spec (geometry transformation recipe)</li>
<li>Links to multiple VARIABLE_SOURCE records</li>
</ul></li>
<li><strong>VARIABLE_SOURCE</strong>: Specifies individual variables
within data sources
<ul>
<li>Many-to-one relationship with DATA_SOURCE</li>
<li>Contains attr_spec (attribute transformation recipe)</li>
<li>Links to ATTR_INDEX for query mapping</li>
</ul></li>
</ul>
<p><br></p>
</div>
<div id="indexing-tables" class="section level3">
<h3><strong>2. Indexing Tables</strong></h3>
<p><strong>GEOM_INDEX</strong> and <strong>ATTR_INDEX</strong> provide
functional mapping to standardized data:</p>
<ul>
<li>Automatically populated from DATA_SOURCE metadata</li>
<li>Enable parameterized querying across disparate tables</li>
<li>Map data source IDs to actual table locations</li>
<li>Support efficient spatial and attribute queries</li>
</ul>
<p><br></p>
</div>
<div id="standardized-place-related-data" class="section level3">
<h3><strong>3. Standardized Place-Related Data</strong></h3>
<p><strong>GEOM_<em>{x}</em></strong> and
<strong>ATTR_<em>{x}</em></strong> tables store harmonized geospatial
data:</p>
<ul>
<li>Each data source gets unique pair of GEOM and ATTR tables</li>
<li>All follow standard template structure (EAV-like format)</li>
<li>Schema and table names determined by DATA_SOURCE fields</li>
<li>Spatial indexes created on all geometry columns</li>
</ul>
<p><br></p>
</div>
</div>
<div id="schema-diagrams" class="section level2">
<h2>Schema Diagrams</h2>
<div id="conceptual-view" class="section level3">
<h3>Conceptual View</h3>
<p><img src="images/schema_3_tier.png" /></p>
<p>The three-tier architecture separates metadata, indexing, and data
storage concerns. Metadata tables define what data exists and how to
transform it. Indexing tables map logical data source identifiers to
physical table locations. Standardized data tables store the harmonized
geospatial data itself.</p>
<p><br></p>
</div>
<div id="relational-summary" class="section level3">
<h3>Relational Summary</h3>
<p><img src="images/rel_diagram_1.png" /></p>
<p>Relationships between key components: DATA_SOURCE contains functional
metadata for datasets. VARIABLE_SOURCE defines variables within
datasets. GEOM_INDEX and ATTR_INDEX map to physical GEOM_* and ATTR_*
tables containing harmonized data.</p>
<p><br></p>
</div>
<div id="full-schema" class="section level3">
<h3>Full Schema</h3>
<p><img src="images/backbone_er.png" /></p>
<p>Complete entity-relationship diagram showing all tables, fields, and
relationships in the gaiaDb backbone schema. Note the indexing tables
that bridge metadata definitions to actual data storage.</p>
<p><br></p>
<hr />
</div>
</div>
</div>
<div id="metadata-tables-1" class="section level1">
<h1><strong>Metadata Tables</strong></h1>
<p><br></p>
<div id="data_source" class="section level2">
<h2>DATA_SOURCE</h2>
<p><img src="images/data_and_var_source.png" /></p>
<p><em>Blue stars signify functional metadata fields</em></p>
<p><br></p>
<p><strong>Purpose</strong>: Catalog external (or local) web-hosted
geospatial datasets</p>
<p><strong>Key characteristics</strong>: - Every record has unique UUID
- Valid when geometry type is consistent (e.g., all census tracts) -
Unique combination of {Organization, Organization Set, Dataset Name} -
Multiple granularities split into separate DATA_SOURCE records</p>
<p><strong>Contains</strong>: - <strong>Descriptive metadata</strong>:
Organization, dataset name, documentation URL, temporal coverage -
<strong>Functional metadata</strong> (★): geom_spec (geometry
transformation recipe), source URL, file format - <strong>Technical
metadata</strong>: Schema name, table prefix, geometry type</p>
<p><strong>Usage</strong>: - First step of data ingestion process -
Referenced by VARIABLE_SOURCE, GEOM_INDEX, ATTR_INDEX (foreign keys) -
Downloaded and ingested by gaiaDb ETL functions - Geometry translation
logic stored in geom_spec field</p>
<p>See <a href="gaia-datamodels.html#data_source">Backbone
Specification: data_source</a> for detailed field definitions.</p>
<p><br></p>
</div>
<div id="variable_source" class="section level2">
<h2>VARIABLE_SOURCE</h2>
<p><strong>Purpose</strong>: Specify individual variables within data
sources and their transformation logic</p>
<p><strong>Key characteristics</strong>: - Many-to-one relationship with
DATA_SOURCE - Each variable from external dataset gets own
VARIABLE_SOURCE record - Links to OMOP vocabulary concepts when
available</p>
<p><strong>Contains</strong>: - <strong>Descriptive metadata</strong>:
Variable name, description, units, temporal coverage -
<strong>Functional metadata</strong> (★): attr_spec (attribute
transformation recipe) - <strong>Vocabulary mapping</strong>: OMOP
concept_id for standardized terminology</p>
<p><strong>Usage</strong>: - Attribute translation logic stored in
attr_spec field - Referenced by ATTR_INDEX for query mapping - Enables
parameterized extraction of specific variables - Links geospatial
attributes to OMOP vocabularies</p>
<p><strong>Example</strong>: - DATA_SOURCE: “CDC Social Vulnerability
Index 2020” - VARIABLE_SOURCE records: “Overall SVI Score”,
“Socioeconomic Theme”, “Household Composition Theme”, etc.</p>
<p>See <a href="gaia-datamodels.html#variable_source">Backbone
Specification: variable_source</a> for detailed field definitions.</p>
<p><br></p>
<hr />
</div>
</div>
<div id="indexing-tables-1" class="section level1">
<h1><strong>Indexing Tables</strong></h1>
<p><br></p>
<p>Indexing tables are automatically populated from DATA_SOURCE metadata
and provide functional mapping to enable parameterized querying across
disparate schemas and tables.</p>
<p><img src="images/rel_diagram_1.png" /></p>
<p><br></p>
<p><img src="images/backbone_slice_1.png" /></p>
<p><em>Indexing tables bridge metadata definitions to physical data
storage</em></p>
<p><br></p>
<div id="geom_index" class="section level2">
<h2>GEOM_INDEX</h2>
<p><img src="images/geom_index.png" /></p>
<p><strong>Purpose</strong>: Map data source IDs to physical geometry
table locations</p>
<p><strong>Key fields</strong>: - <strong>data_source_id</strong>: Links
to DATA_SOURCE.uuid - <strong>schema_name</strong>: PostgreSQL schema
containing geometry table - <strong>table_name</strong>: Name of GEOM_*
table - <strong>geometry_type</strong>: PostGIS geometry type (POLYGON,
POINT, etc.)</p>
<p><strong>Usage</strong>: - Enables queries like “get all geometries
for data_source_id X” - Supports parameterized spatial queries across
sources - Automatically updated when new data sources ingested</p>
<p>See <a href="gaia-datamodels.html#geom_index">Backbone Specification:
geom_index</a> for complete definition.</p>
<p><br></p>
</div>
<div id="attr_index" class="section level2">
<h2>ATTR_INDEX</h2>
<p><img src="images/attr_index.png" /></p>
<p><strong>Purpose</strong>: Map variable IDs to physical attribute
table locations</p>
<p><strong>Key fields</strong>: - <strong>variable_source_id</strong>:
Links to VARIABLE_SOURCE.uuid - <strong>data_source_id</strong>: Links
to DATA_SOURCE.uuid - <strong>schema_name</strong>: PostgreSQL schema
containing attribute table - <strong>table_name</strong>: Name of ATTR_*
table - <strong>column_name</strong>: Specific column in ATTR table</p>
<p><strong>Usage</strong>: - Enables queries like “get attribute values
for variable_source_id Y” - Supports extraction of specific variables
across data sources - Facilitates spatiotemporal joins for exposure
calculations</p>
<p>See <a href="gaia-datamodels.html#attr_index">Backbone Specification:
attr_index</a> for complete definition.</p>
<p><br></p>
<hr />
</div>
</div>
<div id="standardized-data-storage" class="section level1">
<h1><strong>Standardized Data Storage</strong></h1>
<p><br></p>
<div id="common-data-model-rationale" class="section level2">
<h2>Common Data Model Rationale</h2>
<p>The common data model approach, proven successful for clinical data
(OMOP CDM), provides:</p>
<ol style="list-style-type: decimal">
<li><strong>Interoperability</strong>: Harmonized structure enables
federated research</li>
<li><strong>Extensibility</strong>: Static model supports stable tooling
development</li>
<li><strong>Scalability</strong>: New data sources fit existing
structure</li>
</ol>
<p><strong>Gaia’s approach</strong>: Represent all geospatial data as
<strong>geometry objects with affiliated temporal
attributes</strong></p>
<p><strong>Key transformation</strong>: Convert “wide” tables (variable
columns) to “tall” Entity-Attribute-Value (EAV) structure:</p>
<pre><code>Wide format:
| geom_id | county_name | pop_2020 | income_median | svi_score |

Tall format (EAV):
| geom_id | attribute_name | attribute_value | year |
| 001     | pop_2020       | 50000          | 2020 |
| 001     | income_median  | 65000          | 2020 |
| 001     | svi_score      | 0.45           | 2020 |</code></pre>
<p><strong>Benefits</strong>: - Single standard representation for all
attributes - Static column structure across all data sources - Efficient
querying via indexing - Flexible addition of new variables</p>
<p><br></p>
</div>
<div id="geom_template-and-attr_template" class="section level2">
<h2>GEOM_TEMPLATE and ATTR_TEMPLATE</h2>
<p>Two template tables replicate for every data source:</p>
<p><img src="images/backbone_slice_2v2.png" /></p>
<p><em>Each data source creates unique pair of GEOM and ATTR tables from
templates</em></p>
<p><br></p>
<div id="geom_template" class="section level3">
<h3>GEOM_TEMPLATE</h3>
<p><img src="images/geom_template.png" /></p>
<p><strong>Structure</strong>: - <strong>geom_id</strong>: Unique
identifier for geometry - <strong>geom</strong>: PostGIS geometry object
(polygon, point, line) - <strong>geom_name</strong>: Human-readable name
- <strong>parent_geom_id</strong>: For hierarchical geometries (e.g.,
census tract within county) - <strong>valid_from / valid_to</strong>:
Temporal validity of geometry</p>
<p><strong>Usage</strong>: - Template creates GEOM_* tables for each
data source - Spatial indexes automatically created on geom column -
Supports hierarchical spatial relationships - Temporal versioning for
changing boundaries</p>
<p><br></p>
</div>
<div id="attr_template" class="section level3">
<h3>ATTR_TEMPLATE</h3>
<p><img src="images/attr_template.png" /></p>
<p><strong>Structure</strong>: - <strong>attr_id</strong>: Unique
identifier for attribute record - <strong>geom_id</strong>: Links to
GEOM table - <strong>variable_source_id</strong>: Links to
VARIABLE_SOURCE - <strong>attr_start_date / attr_end_date</strong>:
Temporal coverage of attribute value -
<strong>attr_value_as_number</strong>: Numeric attribute values -
<strong>attr_value_as_string</strong>: Text attribute values -
<strong>attr_value_as_concept_id</strong>: OMOP vocabulary concepts</p>
<p><strong>Usage</strong>: - Template creates ATTR_* tables for each
data source - EAV structure stores all attributes in standard format -
Supports temporal attribute values (e.g., annual census estimates) -
Links attributes to OMOP vocabularies for standardization</p>
<p><br></p>
<hr />
</div>
</div>
</div>
<div id="functional-metadata" class="section level1">
<h1><strong>Functional Metadata</strong></h1>
<p><br></p>
<p>Functional metadata refers to machine-actionable instructions
embedded in metadata records that enable automated data processing. Gaia
uses functional metadata “recipes” to automate retrieval,
transformation, and loading of external datasets.</p>
<div id="purpose" class="section level2">
<h2>Purpose</h2>
<p><strong>Without functional metadata</strong>: - Manual download of
each dataset - Custom transformation code for each source -
Undocumented, non-reproducible ETL processes - Duplication of effort
across sites</p>
<p><strong>With functional metadata</strong>: - Automated retrieval from
source URLs - Standardized transformation via recipes - Documented,
reproducible pipelines - Shared ETL logic across community</p>
<p><br></p>
</div>
<div id="centralized-repository" class="section level2">
<h2>Centralized Repository</h2>
<p>Functional metadata is hosted centrally in
<strong>gaiaCatalog</strong> rather than storing actual datasets:</p>
<p><strong>Benefits</strong>: - Lightweight storage (metadata only, not
data) - Single source of truth for transformation recipes - Community
contributions to shared catalog - Version control for metadata updates -
Reduces duplication of ETL development</p>
<p><strong>Workflow</strong>: 1. Dataset owner/curator creates metadata
record in gaiaCatalog 2. Includes geom_spec and attr_spec transformation
recipes 3. Record published to central catalog 4. Any Gaia instance can
ingest dataset using metadata 5. Community improves/validates
transformation recipes over time</p>
<p><br></p>
</div>
<div id="geom_spec" class="section level2">
<h2>geom_spec</h2>
<p><strong>Purpose</strong>: JSON specification defining how to
transform source geometries into GEOM_* table structure</p>
<p><strong>Contains</strong>: - File format (shapefile, GeoJSON,
geopackage, etc.) - Geometry column name in source data - Geometry type
expected (polygon, point, line) - Coordinate reference system (CRS)
transformation - Geometry name field mapping - Hierarchical relationship
mapping (if applicable) - Validity period extraction (if temporal)</p>
<p><strong>Example structure</strong> (simplified):</p>
<pre class="json"><code>{
  &quot;source_format&quot;: &quot;shapefile&quot;,
  &quot;geometry_column&quot;: &quot;geometry&quot;,
  &quot;geometry_type&quot;: &quot;POLYGON&quot;,
  &quot;source_crs&quot;: &quot;EPSG:4269&quot;,
  &quot;target_crs&quot;: &quot;EPSG:4326&quot;,
  &quot;name_field&quot;: &quot;NAME&quot;,
  &quot;parent_field&quot;: &quot;STATEFP&quot;,
  &quot;valid_from_field&quot;: &quot;YEAR&quot;
}</code></pre>
<p><strong>Execution</strong>: gaiaDb SQL functions parse geom_spec and
execute transformation to populate GEOM_* tables.</p>
<p><br></p>
</div>
<div id="attr_spec" class="section level2">
<h2>attr_spec</h2>
<p><strong>Purpose</strong>: JSON specification defining how to extract
and transform source attributes into ATTR_* table structure</p>
<p><strong>Contains</strong>: - Source column name(s) - Data type
(numeric, string, concept) - Temporal field mapping - Value
transformations (e.g., unit conversions) - OMOP vocabulary mappings (if
applicable) - Default values for missing data - Validation rules</p>
<p><strong>Example structure</strong> (simplified):</p>
<pre class="json"><code>{
  &quot;source_column&quot;: &quot;RPL_THEMES&quot;,
  &quot;data_type&quot;: &quot;numeric&quot;,
  &quot;temporal_field&quot;: &quot;YEAR&quot;,
  &quot;value_transformation&quot;: &quot;multiply_by_100&quot;,
  &quot;omop_concept_id&quot;: 2000000001,
  &quot;valid_range&quot;: [0, 1]
}</code></pre>
<p><strong>Execution</strong>: gaiaDb SQL functions parse attr_spec to
extract, transform, and load attributes into ATTR_* tables.</p>
<p><br></p>
</div>
<div id="creating-functional-metadata" class="section level2">
<h2>Creating Functional Metadata</h2>
<p>Researchers can contribute new datasets by creating metadata
records:</p>
<ol style="list-style-type: decimal">
<li><strong>Identify dataset</strong>: Find publicly-hosted geospatial
dataset</li>
<li><strong>Create DATA_SOURCE record</strong>: Descriptive metadata +
geom_spec</li>
<li><strong>Create VARIABLE_SOURCE records</strong>: One per variable +
attr_spec for each</li>
<li><strong>Test transformation</strong>: Validate recipes work
correctly</li>
<li><strong>Submit to catalog</strong>: Share via GitHub pull
request</li>
<li><strong>Community review</strong>: Working group validates and
merges</li>
</ol>
<p>See <a href="get-started.html#propose-a-use-case">Contributing Data
Sources</a> for detailed instructions.</p>
<p><br></p>
<hr />
</div>
</div>
<div id="design-benefits" class="section level1">
<h1><strong>Design Benefits</strong></h1>
<p><br></p>
<div id="reproducibility" class="section level2">
<h2>Reproducibility</h2>
<ul>
<li><strong>Version-controlled recipes</strong>: Transformation logic
tracked in git</li>
<li><strong>Documented provenance</strong>: Source URLs, versions,
transformation steps</li>
<li><strong>Containerized deployment</strong>: Identical environments
via gaiaDocker</li>
<li><strong>Standardized vocabularies</strong>: OMOP concepts for
semantic interoperability</li>
</ul>
</div>
<div id="scalability" class="section level2">
<h2>Scalability</h2>
<ul>
<li><strong>Efficient storage</strong>: EAV structure with indexing</li>
<li><strong>Parallel processing</strong>: Independent data source
ingestion</li>
<li><strong>Cloud-ready</strong>: Deployable on any infrastructure</li>
<li><strong>Horizontal scaling</strong>: Multiple gaiaCore
instances</li>
</ul>
</div>
<div id="community-growth" class="section level2">
<h2>Community Growth</h2>
<ul>
<li><strong>Shared metadata</strong>: Reduces duplication of effort</li>
<li><strong>Collaborative validation</strong>: Community reviews
transformation recipes</li>
<li><strong>Extensible architecture</strong>: New data sources fit
existing structure</li>
<li><strong>Open source</strong>: All tools and metadata freely
available</li>
</ul>
<p><br></p>
<hr />
</div>
</div>
<div id="learn-more" class="section level1">
<h1><strong>Learn More</strong></h1>
<ul>
<li><strong><a href="gaia-intro.html">Gaia Overview</a></strong>:
Introduction to Gaia toolchain</li>
<li><strong><a
href="developer-architecture.html">Architecture</a></strong>: Technical
architecture and data flows</li>
<li><strong><a href="vocabulary.html">Vocabulary</a></strong>: OMOP GIS
vocabulary package</li>
<li><strong><a href="get-started.html">Get Started</a></strong>: Deploy
Gaia and join the working group</li>
</ul>
<p><br></p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>

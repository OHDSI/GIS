---
title: "3_implementation"
output: html_document
---

This section outlines the implementation framework for the OMOP GIS Vocabulary Package, detailing both the underlying ontology architecture and the practical processes for vocabulary ingestion and deployment. By combining semantic formalism with operational scalability, the implementation ensures that spatial and contextual vocabularies are conceptually aligned with the OMOP CDM and readily usable in real-world analytics environments.

## Custom Vocabulary Builder (CVB)

The OMOP GIS Vocabulary Package is developed and maintained using the **Custom Vocabulary Builder (CVB)**, an automated workflow tool maintained by Tufts CTSI. CVB enables collaborative vocabulary development by bringing together clinicians, ontologists, and domain experts to validate mappings through a streamlined continuous integration process.

### What is CVB?

CVB is an automated process that produces relational custom vocabulary (two billion range concepts) with relationships, ancestry, and mappings. It supports analytics in a provisional sense while vocabulary terms are evaluated and validated through broader review mechanisms within the OHDSI vocabulary team.

**Key Features**:

- **Collaborative validation**: Google Sheets interface for clinician and ontology expert review
- **Automated pipeline**: Continuous integration workflow from source mappings to delta vocabulary tables
- **SSSOM compliance**: Uses the Simple Standard for Sharing Ontology Mappings (SSSOM) framework
- **Version control**: Git-based tracking of vocabulary changes and mapping provenance
- **Mapping metadata**: Captures who performed mappings, how they were done, and confidence levels

### CVB Workflow

The CVB workflow integrates several components:

1. **Data Entry & Validation** (Google Sheets)
   - Clinicians and domain experts validate mappings in a familiar spreadsheet environment
   - SSSOM-structured rows represent source-to-standard mappings with relationship identifiers
   - Google Apps Script integration enables automated interactions with version control

2. **Continuous Integration** (GitHub + Azure)
   - Validated mappings automatically sync from Google Sheets to GitHub
   - GitHub Actions trigger vocabulary build processes on self-hosted runners
   - SQL-based build pipeline checks mappings against standard vocabularies (Athena)
   - New concepts are assigned two billion range IDs with full OMOP vocabulary structure

3. **Delta Vocabulary Output**
   - Generated delta tables contain all custom concepts not in standard Athena vocabulary
   - Includes: CONCEPT, CONCEPT_RELATIONSHIP, CONCEPT_ANCESTOR, DOMAIN, CONCEPT_CLASS tables
   - Mapping metadata CSV preserves provenance and validation history
   - Version-controlled release tags enable reproducible research

### CVB and GIS Vocabularies

The OMOP GIS Vocabulary Package leverages CVB to create three interconnected vocabulary components:

- **OMOP GIS Vocabulary**: Geographic entities, spatial relationships, and geometry types
- **OMOP Exposome Vocabulary**: Environmental toxins, pollutants, and chemical exposures
- **OMOP SDoH Vocabulary**: Social determinants of health from multiple authoritative sources (ADI, AHRQ, COI, EJI, SEDH, SVI, SDG, SDOHO)

CVB enables the GIS Working Group to rapidly iterate on vocabulary development in response to specific use cases while maintaining:

- Traceability of mapping decisions
- Collaborative validation by domain experts
- Automated testing and integration
- Seamless updates as new data sources emerge

### Technical Implementation

**Repository**: [TuftsCTSI/CVB](https://github.com/TuftsCTSI/CVB)

The CVB implementation for GIS vocabularies includes:

- Google Sheets validation workflows for each vocabulary component
- Automated nightly builds triggered by mapping updates
- SQL-based vocabulary construction using lightweight Ubuntu runners
- Delta vocabulary tables published to [CVB/GIS/Ontology](https://github.com/TuftsCTSI/CVB/tree/main/GIS/Ontology)

**Build Pipeline**:

```
Source Mappings (Google Sheets)
    ↓ [App Script automation]
GitHub (CSV mappings)
    ↓ [GitHub Actions]
Azure Runner (SQL build logic)
    ↓ [Vocabulary construction]
Delta Tables + Metadata
    ↓ [Version control]
GitHub Release (versioned vocabulary)
```

### Integration with OHDSI

CVB complements existing OHDSI vocabulary processes by:

- Enabling rapid prototyping of vocabularies for emerging use cases
- Providing provisional concepts while formal vocabulary review is underway
- Maintaining full OMOP vocabulary structure and relationships
- Supporting seamless integration with HADES analytics tools
- Facilitating eventual migration of validated concepts to standard vocabularies

The GIS vocabulary package demonstrates CVB's capability to handle complex, multi-domain vocabularies with extensive hierarchies and relationships, serving as a model for other specialized OHDSI vocabulary development efforts.

### Resources

- **CVB Repository**: [github.com/TuftsCTSI/CVB](https://github.com/TuftsCTSI/CVB)
- **GIS Delta Vocabularies**: [CVB/GIS/Ontology](https://github.com/TuftsCTSI/CVB/tree/main/GIS/Ontology)
- **SSSOM Framework Presentation**: [Youtube OHDSI Global 2023](https://www.youtube.com/watch?v=bRxBrhCstj4)
- **Validation Spreadsheet**: [Google Sheets](https://docs.google.com/spreadsheets/d/1hMLjKokFCpoDqC_WsAd7ZXyBKDmnPif2rR9DlQ9X7cs/edit?usp=sharing)
- **DevCon Presentation**: [Youtube DevCon](https://youtu.be/Jjbyb_Yvt0o?t=1244)

<br>
